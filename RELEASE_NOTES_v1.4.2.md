# StartPCApp v1.4.2 发布说明

## 🔧 重要修复

### WebView2 数据目录权限问题修复
- **修复数据目录权限错误**: 将WebView2数据目录从程序安装目录迁移到用户AppData目录
- **解决"拒绝访问"错误**: 避免在Program Files等受保护目录创建数据文件
- **修复"Expecting object to be local"错误**: 改进WebView2环境初始化逻辑
- **增强沙盒兼容性**: 添加`--no-sandbox`和`--disable-gpu-sandbox`参数

### 错误处理和诊断改进
- **详细错误分类**: 针对不同错误类型提供具体解决方案
- **错误日志记录**: 自动记录详细错误信息到`%AppData%\StartPCApp\error.log`
- **改进回退界面**: 更友好的错误提示界面，包含具体解决步骤
- **智能错误识别**: 根据错误类型自动推荐最佳解决方案

### 技术改进
- **用户数据目录**: `%AppData%\StartPCApp\WebView2Data`
- **设置文件位置**: `%AppData%\StartPCApp\settings.txt`
- **错误日志位置**: `%AppData%\StartPCApp\error.log`
- **版本号更新**: 1.4.1 → 1.4.2

## 📦 发布文件

- **便携版**: `StartPCApp-Portable-v1.4.2-Fixed.zip`
- **安装程序**: `StartPCApp_Setup.exe`
- **发布说明**: `RELEASE_NOTES_v1.4.2.md`

## 🚀 使用说明

### 系统要求
- Windows 7/8/8.1/10/11 (x64)
- .NET 6 运行时 (便携版已包含)
- Microsoft Edge WebView2 运行时

### 安装方式

#### 方式一：便携版 (推荐)
1. 下载 `StartPCApp-Portable-v1.4.2-Fixed.zip`
2. 解压到任意目录
3. 运行 `StartPCApp.exe` (无需管理员权限)

#### 方式二：安装程序
1. 下载 `StartPCApp_Setup.exe`
2. 以管理员身份运行安装程序
3. 按照向导完成安装

### 故障排除

#### WebView2 相关问题
如果仍然遇到WebView2错误：
1. **下载WebView2运行时**: 访问Microsoft官网下载最新版本
2. **更新Microsoft Edge**: 确保使用最新版本的Edge浏览器
3. **检查系统兼容性**: 确认系统支持WebView2
4. **查看错误日志**: 检查`%AppData%\StartPCApp\error.log`获取详细信息

#### 权限问题
- 程序现在使用用户目录，通常无需管理员权限
- 如果仍有问题，尝试以管理员身份运行
- 检查防病毒软件是否阻止程序运行

## ✨ 功能特性

### 全局热键
- **Alt+Q**: 一键关机（需确认）
- **Alt+W**: 定时关机（1-1440分钟可选）
- **Alt+E**: 界面缩放调整（75%-200%，6种比例）
- **Alt+R**: 自定义网页URL设置（支持记忆功能）
- **ESC**: 退出程序

### 技术特性
- **.NET 6**: 现代化的跨平台框架
- **WebView2**: 内嵌现代浏览器引擎
- **全局热键**: 系统级热键监听
- **高DPI支持**: 适配高分辨率显示器
- **安全设计**: 关机操作需要确认
- **用户目录**: 避免权限问题

## 🔄 从旧版本升级

### 自动迁移
- 设置文件会自动从旧位置迁移到新的用户目录
- WebView2数据会重新初始化（不影响功能）
- 无需手动操作

### 清理旧文件（可选）
如果从v1.4.1或更早版本升级，可以手动删除以下旧文件：
- 程序目录下的`StartPCApp.exe.WebView2`文件夹
- 旧的设置文件（如果存在）

## 📞 技术支持

如果遇到问题，请：
1. 查看本发布说明的故障排除部分
2. 检查错误日志文件：`%AppData%\StartPCApp\error.log`
3. 搜索现有的 GitHub Issues
4. 创建新的 Issue 描述问题，并附上错误日志

## 🎯 已知问题

- 某些企业环境可能仍需要管理员权限
- 部分防病毒软件可能误报，请添加到白名单
- Windows 7系统需要安装.NET 6运行时

---

**感谢使用 StartPCApp！如果这个项目对你有帮助，请给它一个 ⭐️！**

**v1.4.2 专注于解决用户反馈的权限和初始化问题，提供更稳定的使用体验。**